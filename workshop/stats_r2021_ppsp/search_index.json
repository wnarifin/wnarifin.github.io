[["index.html", "Statistical Analysis Using RStudio About", " Statistical Analysis Using RStudio Wan Nor Arifin 25 October 2021 About Notes for Statistical Analysis Using RStudio, R Workshop 2021, PPSP, USM. "],["linear-regression.html", "Chapter 1 Linear Regression 1.1 Introduction 1.2 Preliminaries 1.3 Simple linear regression (SLR) 1.4 Multiple linear regression (MLR) 1.5 Exercises", " Chapter 1 Linear Regression 1.1 Introduction A statistical method to model relationship between: outcome: numerical variable. predictors/independent variables: numerical, categorical variables. A type of Generalized Linear Models (GLMs), which also includes other outcome types, e.g. categorical and count. Basically, the linear relationship is structured as follows, \\[numerical\\ outcome = numerical\\ predictors + categorical\\ predictors\\] 1.2 Preliminaries 1.2.1 Library # official CRAN library(foreign) library(tidyverse) ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ── ## ✓ ggplot2 3.3.5 ✓ purrr 0.3.4 ## ✓ tibble 3.1.5 ✓ dplyr 1.0.7 ## ✓ tidyr 1.1.4 ✓ stringr 1.4.0 ## ✓ readr 2.0.0 ✓ forcats 0.5.1 ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(gtsummary) library(ggplot2) library(ggpubr) library(GGally) ## Registered S3 method overwritten by &#39;GGally&#39;: ## method from ## +.gg ggplot2 library(psych) ## ## Attaching package: &#39;psych&#39; ## The following objects are masked from &#39;package:ggplot2&#39;: ## ## %+%, alpha library(rsq) library(broom) library(car) ## Loading required package: carData ## ## Attaching package: &#39;car&#39; ## The following object is masked from &#39;package:psych&#39;: ## ## logit ## The following object is masked from &#39;package:dplyr&#39;: ## ## recode ## The following object is masked from &#39;package:purrr&#39;: ## ## some # custom function # desc_cat() source(&quot;https://raw.githubusercontent.com/wnarifin/medicalstats-in-R/master/functions/desc_cat_fun.R&quot;) 1.2.2 Data coronary = read.dta(&quot;coronary.dta&quot;) str(coronary) ## &#39;data.frame&#39;: 200 obs. of 9 variables: ## $ id : num 1 14 56 61 62 64 69 108 112 134 ... ## $ cad : Factor w/ 2 levels &quot;no cad&quot;,&quot;cad&quot;: 1 1 1 1 1 1 2 1 1 1 ... ## $ sbp : num 106 130 136 138 115 124 110 112 138 104 ... ## $ dbp : num 68 78 84 100 85 72 80 70 85 70 ... ## $ chol : num 6.57 6.33 5.97 7.04 6.66 ... ## $ age : num 60 34 36 45 53 43 44 50 43 48 ... ## $ bmi : num 38.9 37.8 40.5 37.6 40.3 ... ## $ race : Factor w/ 3 levels &quot;malay&quot;,&quot;chinese&quot;,..: 3 1 1 1 3 1 1 2 2 2 ... ## $ gender: Factor w/ 2 levels &quot;woman&quot;,&quot;man&quot;: 1 1 1 1 2 2 2 1 1 2 ... ## - attr(*, &quot;datalabel&quot;)= chr &quot;Written by R. &quot; ## - attr(*, &quot;time.stamp&quot;)= chr &quot;&quot; ## - attr(*, &quot;formats&quot;)= chr &quot;%9.0g&quot; &quot;%9.0g&quot; &quot;%9.0g&quot; &quot;%9.0g&quot; ... ## - attr(*, &quot;types&quot;)= int 100 108 100 100 100 100 100 108 108 ## - attr(*, &quot;val.labels&quot;)= chr &quot;&quot; &quot;cad&quot; &quot;&quot; &quot;&quot; ... ## - attr(*, &quot;var.labels&quot;)= chr &quot;id&quot; &quot;cad&quot; &quot;sbp&quot; &quot;dbp&quot; ... ## - attr(*, &quot;version&quot;)= int 7 ## - attr(*, &quot;label.table&quot;)=List of 3 ## ..$ cad : Named int 1 2 ## .. ..- attr(*, &quot;names&quot;)= chr &quot;no cad&quot; &quot;cad&quot; ## ..$ race : Named int 1 2 3 ## .. ..- attr(*, &quot;names&quot;)= chr &quot;malay&quot; &quot;chinese&quot; &quot;indian&quot; ## ..$ gender: Named int 1 2 ## .. ..- attr(*, &quot;names&quot;)= chr &quot;woman&quot; &quot;man&quot; Descriptive statistics tbl_summary(coronary) # median IQR html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #glvjqvvubh .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #glvjqvvubh .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #glvjqvvubh .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #glvjqvvubh .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #glvjqvvubh .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #glvjqvvubh .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #glvjqvvubh .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #glvjqvvubh .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #glvjqvvubh .gt_column_spanner_outer:first-child { padding-left: 0; } #glvjqvvubh .gt_column_spanner_outer:last-child { padding-right: 0; } #glvjqvvubh .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #glvjqvvubh .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #glvjqvvubh .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #glvjqvvubh .gt_from_md > :first-child { margin-top: 0; } #glvjqvvubh .gt_from_md > :last-child { margin-bottom: 0; } #glvjqvvubh .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #glvjqvvubh .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #glvjqvvubh .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #glvjqvvubh .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #glvjqvvubh .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #glvjqvvubh .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #glvjqvvubh .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #glvjqvvubh .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #glvjqvvubh .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #glvjqvvubh .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #glvjqvvubh .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #glvjqvvubh .gt_sourcenote { font-size: 90%; padding: 4px; } #glvjqvvubh .gt_left { text-align: left; } #glvjqvvubh .gt_center { text-align: center; } #glvjqvvubh .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #glvjqvvubh .gt_font_normal { font-weight: normal; } #glvjqvvubh .gt_font_bold { font-weight: bold; } #glvjqvvubh .gt_font_italic { font-style: italic; } #glvjqvvubh .gt_super { font-size: 65%; } #glvjqvvubh .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Characteristic N = 2001 id 2,244 (902, 3,347) cad no cad 163 (82%) cad 37 (18%) sbp 126 (115, 144) dbp 80 (72, 92) chol 6.19 (5.39, 6.89) age 47 (42, 53) bmi 37.80 (36.10, 39.20) race malay 73 (36%) chinese 64 (32%) indian 63 (32%) gender woman 100 (50%) man 100 (50%) 1 Median (IQR); n (%) coronary %&gt;% select(-id) %&gt;% tbl_summary(statistic = all_continuous() ~ &quot;{mean} ({sd})&quot;, digits = all_continuous() ~ 1) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #teeqyrodkm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #teeqyrodkm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #teeqyrodkm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #teeqyrodkm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #teeqyrodkm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #teeqyrodkm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #teeqyrodkm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #teeqyrodkm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #teeqyrodkm .gt_column_spanner_outer:first-child { padding-left: 0; } #teeqyrodkm .gt_column_spanner_outer:last-child { padding-right: 0; } #teeqyrodkm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #teeqyrodkm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #teeqyrodkm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #teeqyrodkm .gt_from_md > :first-child { margin-top: 0; } #teeqyrodkm .gt_from_md > :last-child { margin-bottom: 0; } #teeqyrodkm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #teeqyrodkm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #teeqyrodkm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #teeqyrodkm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #teeqyrodkm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #teeqyrodkm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #teeqyrodkm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #teeqyrodkm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #teeqyrodkm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #teeqyrodkm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #teeqyrodkm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #teeqyrodkm .gt_sourcenote { font-size: 90%; padding: 4px; } #teeqyrodkm .gt_left { text-align: left; } #teeqyrodkm .gt_center { text-align: center; } #teeqyrodkm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #teeqyrodkm .gt_font_normal { font-weight: normal; } #teeqyrodkm .gt_font_bold { font-weight: bold; } #teeqyrodkm .gt_font_italic { font-style: italic; } #teeqyrodkm .gt_super { font-size: 65%; } #teeqyrodkm .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Characteristic N = 2001 cad no cad 163 (82%) cad 37 (18%) sbp 130.2 (19.8) dbp 82.3 (12.9) chol 6.2 (1.2) age 47.3 (7.3) bmi 37.4 (2.7) race malay 73 (36%) chinese 64 (32%) indian 63 (32%) gender woman 100 (50%) man 100 (50%) 1 n (%); Mean (SD) Customization: http://www.danieldsjoberg.com/gtsummary/index.html 1.3 Simple linear regression (SLR) 1.3.1 About SLR Model linear (straight line) relationship between: outcome: numerical variable. a predictor: numerical variable (only). Note: What if the predictor is a categorical variable? Usually handled that with one-way ANOVA. Formula, \\[numerical\\ outcome = intercept + coefficient \\times numerical\\ predictor\\] in short, \\[\\hat y = \\beta_0 + \\beta_1x_1\\] where \\(\\hat y\\) is the predicted value of the outcome y. 1.3.2 Data exploration Descriptive statistics coronary %&gt;% select(chol, dbp) %&gt;% describe() ## vars n mean sd median trimmed mad min max range skew kurtosis ## chol 1 200 6.20 1.18 6.19 6.18 1.18 4 9.35 5.35 0.18 -0.31 ## dbp 2 200 82.31 12.90 80.00 81.68 14.83 56 120.00 64.00 0.42 -0.33 ## se ## chol 0.08 ## dbp 0.91 Plots hist_chol = ggplot(coronary, aes(chol)) + geom_histogram(color = &quot;blue&quot;, fill = &quot;white&quot;) hist_dbp = ggplot(coronary, aes(dbp)) + geom_histogram(color = &quot;red&quot;, fill = &quot;white&quot;) bplot_chol = ggplot(coronary, aes(chol)) + geom_boxplot(color = &quot;blue&quot;, ) bplot_dbp = ggplot(coronary, aes(dbp)) + geom_boxplot(color = &quot;red&quot;) ggarrange(hist_chol, bplot_chol, hist_dbp, bplot_dbp) ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. 1.3.3 Fit Univariable SLR Fit model, # chol ~ dbp slr_chol = glm(chol ~ dbp, data = coronary) summary(slr_chol) ## ## Call: ## glm(formula = chol ~ dbp, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.9967 -0.8304 -0.1292 0.7734 2.8470 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 2.995134 0.492092 6.087 5.88e-09 *** ## dbp 0.038919 0.005907 6.589 3.92e-10 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.154763) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 228.64 on 198 degrees of freedom ## AIC: 600.34 ## ## Number of Fisher Scoring iterations: 2 tidy(slr_chol, conf.int = TRUE) # broom package ## # A tibble: 2 × 7 ## term estimate std.error statistic p.value conf.low conf.high ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (Intercept) 3.00 0.492 6.09 5.88e- 9 2.03 3.96 ## 2 dbp 0.0389 0.00591 6.59 3.92e-10 0.0273 0.0505 Important results, Coefficient, \\(\\beta\\). 95% CI. P-value. Obtain \\(R^2\\), % of variance explained, rsq(slr_chol, adj = T) ## [1] 0.1756834 Adjusted R^2 - penalized for number of predictor p. Scatter plot, plot_slr = ggplot(coronary, aes(x = dbp, y = chol)) + geom_point() + geom_smooth(method = lm) plot_slr ## `geom_smooth()` using formula &#39;y ~ x&#39; # plot(chol ~ dbp, data = coronary) # abline(slr_chol) # or using built-in graphics this allows assessment of normality, linearity and equal variance assumptions. We expect eliptical/oval shape (normality), equal scatter of dots on both sides of the prediction line (equal variance). Both these indicate linear relationship between chol and dbp. 1.3.4 Interpretation 1mmHg increase in DBP causes 0.04mmol/L increase in cholestrol. DBP explains 17.6% variance in cholestrol. 1.3.5 Model equation \\[chol = 3.0 + 0.04\\times dbp\\] 1.4 Multiple linear regression (MLR) 1.4.1 About MLR Model linear relationship between: outcome: numerical variable. predictors: numerical, categorical variables. Note: MLR is a term that refers to linear regression with two or more numerical variables. Whenever we have both numerical and categorical variables, the proper term for the regression model is General Linear Model. However, we will use the term MLR in this workshop. Formula, \\[\\begin{aligned} numerical\\ outcome = &amp;\\ intercept + coefficients \\times numerical\\ predictors \\\\ &amp; + coefficients \\times categorical\\ predictors \\end{aligned}\\] in a shorter form, \\[\\hat y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + ... + \\beta_kx_k\\] where we have k predictors. Whenever the predictor is a categorical variable with more than two levels, we use dummy variable(s). This can be easily specified in R using factor() if the variable is not yet properly specified as such. There is no problem with binary categorical variable. For a categorical variable with more than two levels, the number of dummy variables (i.e. once turned into several binary variables) equals number of levels minus one. For example, whenever we have four levels, we will obtain three dummy (binary) variables. 1.4.2 Data exploration Descriptive statistics coronary %&gt;% select(-id, -cad, -race, -gender) %&gt;% describe() # numerical ## vars n mean sd median trimmed mad min max range skew ## sbp 1 200 130.18 19.81 126.00 128.93 17.79 88.00 187.00 99.00 0.53 ## dbp 2 200 82.31 12.90 80.00 81.68 14.83 56.00 120.00 64.00 0.42 ## chol 3 200 6.20 1.18 6.19 6.18 1.18 4.00 9.35 5.35 0.18 ## age 4 200 47.33 7.34 47.00 47.27 8.15 32.00 62.00 30.00 0.05 ## bmi 5 200 37.45 2.68 37.80 37.65 2.37 28.99 45.03 16.03 -0.55 ## kurtosis se ## sbp -0.37 1.40 ## dbp -0.33 0.91 ## chol -0.31 0.08 ## age -0.78 0.52 ## bmi 0.42 0.19 coronary %&gt;% select(race, gender) %&gt;% desc_cat() # categorical ## $race ## Variable Label n Percent ## 1 race malay 73 36.5 ## 2 - chinese 64 32.0 ## 3 - indian 63 31.5 ## ## $gender ## Variable Label n Percent ## 1 gender woman 100 50 ## 2 - man 100 50 # or just use # coronary %&gt;% select(race, gender) %&gt;% tbl_summary() Plots coronary %&gt;% select(-id, -cad) %&gt;% ggpairs() ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. # coronary %&gt;% select(-id, -cad) %&gt;% plot() # or using built-in graphics 1.4.3 Variable selection Fit Univariable SLR Perform SLR for chol, sbp, dbp and bmi on your own as shown above. Now, we are concerned with which variables are worthwhile to include in the multivariable models. In the context of exploratory research, we want to choose only variables with P-values &lt; 0.25 to be included in MLR. Obtaining the P-values for each variable is easy by LR test, slr_chol0 = glm(chol ~ 1, data = coronary) summary(slr_chol0) ## ## Call: ## glm(formula = chol ~ 1, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.19854 -0.80854 -0.01104 0.69021 3.15146 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 6.19854 0.08369 74.06 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.400874) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 278.77 on 199 degrees of freedom ## AIC: 637.99 ## ## Number of Fisher Scoring iterations: 2 add1(slr_chol0, scope = ~ sbp + dbp + age + bmi + race + gender, test = &quot;LRT&quot;) ## Single term additions ## ## Model: ## chol ~ 1 ## Df Deviance AIC scaled dev. Pr(&gt;Chi) ## &lt;none&gt; 278.77 637.99 ## sbp 1 235.36 606.14 33.855 5.938e-09 *** ## dbp 1 228.64 600.34 39.648 3.042e-10 *** ## age 1 243.68 613.08 26.911 2.130e-07 *** ## bmi 1 272.17 635.20 4.792 0.02859 * ## race 2 241.68 613.43 28.561 6.280e-07 *** ## gender 1 277.45 639.04 0.952 0.32933 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 All variables are significant with P &lt; .25 except gender. However, in the context of confirmatory research, what we want to include are not merely based on P-values alone. It is important to consider expert judgement as well. Fit Multivariable MLR Modeling considerations: select either sbp / dbp! redundant based on plot before, highly correlated gender not sig., may exclude for exercise reason, exclude age Now, perform MLR with all selected variables i.e. P &lt; .25 and above considerations, mlr_chol = glm(chol ~ dbp + bmi + race, data = coronary) summary(mlr_chol) ## ## Call: ## glm(formula = chol ~ dbp + bmi + race, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.18698 -0.73076 -0.01935 0.63476 2.91524 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 4.870859 1.245373 3.911 0.000127 *** ## dbp 0.029500 0.006203 4.756 3.83e-06 *** ## bmi -0.038530 0.028099 -1.371 0.171871 ## racechinese 0.356642 0.181757 1.962 0.051164 . ## raceindian 0.724716 0.190625 3.802 0.000192 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.083909) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 211.36 on 195 degrees of freedom ## AIC: 590.63 ## ## Number of Fisher Scoring iterations: 2 rsq(mlr_chol, adj = T) ## [1] 0.2262622 Focus on, Coefficients, \\(\\beta\\)s. 95% CI. P-values. For model fit, \\(R^2\\) – % of variance explained by the model. Stepwise As you can see, not all variables included in the model are significant. How to select? We proceed with stepwise automatic selection. It ismportant to know stepwise/automatic selection is meant for exploratory analysis. For confirmatory analysis, expert opinion in variable selection is preferable. # both mlr_chol_stepboth = step(mlr_chol, direction = &quot;both&quot;) ## Start: AIC=590.63 ## chol ~ dbp + bmi + race ## ## Df Deviance AIC ## - bmi 1 213.40 590.55 ## &lt;none&gt; 211.36 590.63 ## - race 2 227.04 600.94 ## - dbp 1 235.88 610.58 ## ## Step: AIC=590.55 ## chol ~ dbp + race ## ## Df Deviance AIC ## &lt;none&gt; 213.40 590.55 ## + bmi 1 211.36 590.63 ## - race 2 228.64 600.34 ## - dbp 1 241.68 613.43 summary(mlr_chol_stepboth) ## ## Call: ## glm(formula = chol ~ dbp + race, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.1378 -0.7068 -0.0289 0.5997 2.7778 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.298028 0.486213 6.783 1.36e-10 *** ## dbp 0.031108 0.006104 5.096 8.14e-07 *** ## racechinese 0.359964 0.182149 1.976 0.049534 * ## raceindian 0.713690 0.190883 3.739 0.000243 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.088777) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 213.40 on 196 degrees of freedom ## AIC: 590.55 ## ## Number of Fisher Scoring iterations: 2 # forward mlr_chol_stepforward = step(slr_chol0, scope = ~ dbp + bmi + race, direction = &quot;forward&quot;) ## Start: AIC=637.99 ## chol ~ 1 ## ## Df Deviance AIC ## + dbp 1 228.64 600.34 ## + race 2 241.68 613.43 ## + bmi 1 272.17 635.20 ## &lt;none&gt; 278.77 637.99 ## ## Step: AIC=600.34 ## chol ~ dbp ## ## Df Deviance AIC ## + race 2 213.40 590.55 ## &lt;none&gt; 228.64 600.34 ## + bmi 1 227.04 600.94 ## ## Step: AIC=590.55 ## chol ~ dbp + race ## ## Df Deviance AIC ## &lt;none&gt; 213.40 590.55 ## + bmi 1 211.36 590.63 summary(mlr_chol_stepforward) # same with both ## ## Call: ## glm(formula = chol ~ dbp + race, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.1378 -0.7068 -0.0289 0.5997 2.7778 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.298028 0.486213 6.783 1.36e-10 *** ## dbp 0.031108 0.006104 5.096 8.14e-07 *** ## racechinese 0.359964 0.182149 1.976 0.049534 * ## raceindian 0.713690 0.190883 3.739 0.000243 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.088777) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 213.40 on 196 degrees of freedom ## AIC: 590.55 ## ## Number of Fisher Scoring iterations: 2 # backward mlr_chol_stepback = step(mlr_chol, direction = &quot;backward&quot;) ## Start: AIC=590.63 ## chol ~ dbp + bmi + race ## ## Df Deviance AIC ## - bmi 1 213.40 590.55 ## &lt;none&gt; 211.36 590.63 ## - race 2 227.04 600.94 ## - dbp 1 235.88 610.58 ## ## Step: AIC=590.55 ## chol ~ dbp + race ## ## Df Deviance AIC ## &lt;none&gt; 213.40 590.55 ## - race 2 228.64 600.34 ## - dbp 1 241.68 613.43 summary(mlr_chol_stepback) # same with both ## ## Call: ## glm(formula = chol ~ dbp + race, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.1378 -0.7068 -0.0289 0.5997 2.7778 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.298028 0.486213 6.783 1.36e-10 *** ## dbp 0.031108 0.006104 5.096 8.14e-07 *** ## racechinese 0.359964 0.182149 1.976 0.049534 * ## raceindian 0.713690 0.190883 3.739 0.000243 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.088777) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 213.40 on 196 degrees of freedom ## AIC: 590.55 ## ## Number of Fisher Scoring iterations: 2 Our chosen model: chol ~ dbp + race mlr_chol_sel = glm(chol ~ dbp + race, data = coronary) summary(mlr_chol_sel) ## ## Call: ## glm(formula = chol ~ dbp + race, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.1378 -0.7068 -0.0289 0.5997 2.7778 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.298028 0.486213 6.783 1.36e-10 *** ## dbp 0.031108 0.006104 5.096 8.14e-07 *** ## racechinese 0.359964 0.182149 1.976 0.049534 * ## raceindian 0.713690 0.190883 3.739 0.000243 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.088777) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 213.40 on 196 degrees of freedom ## AIC: 590.55 ## ## Number of Fisher Scoring iterations: 2 tidy(mlr_chol_sel, conf.int = TRUE) ## # A tibble: 4 × 7 ## term estimate std.error statistic p.value conf.low conf.high ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (Intercept) 3.30 0.486 6.78 1.36e-10 2.35 4.25 ## 2 dbp 0.0311 0.00610 5.10 8.14e- 7 0.0191 0.0431 ## 3 racechinese 0.360 0.182 1.98 4.95e- 2 0.00296 0.717 ## 4 raceindian 0.714 0.191 3.74 2.43e- 4 0.340 1.09 tbl_regression(mlr_chol_sel) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kjrzdpxagu .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kjrzdpxagu .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kjrzdpxagu .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kjrzdpxagu .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kjrzdpxagu .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kjrzdpxagu .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kjrzdpxagu .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kjrzdpxagu .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kjrzdpxagu .gt_column_spanner_outer:first-child { padding-left: 0; } #kjrzdpxagu .gt_column_spanner_outer:last-child { padding-right: 0; } #kjrzdpxagu .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kjrzdpxagu .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kjrzdpxagu .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kjrzdpxagu .gt_from_md > :first-child { margin-top: 0; } #kjrzdpxagu .gt_from_md > :last-child { margin-bottom: 0; } #kjrzdpxagu .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kjrzdpxagu .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kjrzdpxagu .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kjrzdpxagu .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kjrzdpxagu .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kjrzdpxagu .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kjrzdpxagu .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kjrzdpxagu .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kjrzdpxagu .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kjrzdpxagu .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kjrzdpxagu .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kjrzdpxagu .gt_sourcenote { font-size: 90%; padding: 4px; } #kjrzdpxagu .gt_left { text-align: left; } #kjrzdpxagu .gt_center { text-align: center; } #kjrzdpxagu .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kjrzdpxagu .gt_font_normal { font-weight: normal; } #kjrzdpxagu .gt_font_bold { font-weight: bold; } #kjrzdpxagu .gt_font_italic { font-style: italic; } #kjrzdpxagu .gt_super { font-size: 65%; } #kjrzdpxagu .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Characteristic Beta 95% CI1 p-value dbp 0.03 0.02, 0.04 race malay — — chinese 0.36 0.00, 0.72 0.050 indian 0.71 0.34, 1.1 1 CI = Confidence Interval rsq(mlr_chol_sel) ## [1] 0.2345037 Multicollinearity, MC Multicollinearity is the problem of repetitive/redundant variables – high correlations between predictors. MC is checked by Variance Inflation Factor (VIF). VIF &gt; 10 indicates MC problem. vif(mlr_chol_sel) # all &lt; 10 ## GVIF Df GVIF^(1/(2*Df)) ## dbp 1.132753 1 1.064309 ## race 1.132753 2 1.031653 Interaction, * Interaction is the predictor variable combination that requires interpretation of regression coefficients separately based on the levels of the predictor (e.g. separate analysis for each race group, Malay vs Chinese vs Indian). This makes interpreting our analysis complicated. So, most of the time, we pray not to have interaction in our regression model. summary(glm(chol ~ dbp * race, data = coronary)) # dbp * race not sig. ## ## Call: ## glm(formula = chol ~ dbp * race, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.10485 -0.77524 -0.02423 0.58059 2.74380 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 2.11114 0.92803 2.275 0.024008 * ## dbp 0.04650 0.01193 3.897 0.000134 *** ## racechinese 1.95576 1.28477 1.522 0.129572 ## raceindian 2.41530 1.25766 1.920 0.056266 . ## dbp:racechinese -0.02033 0.01596 -1.273 0.204376 ## dbp:raceindian -0.02126 0.01529 -1.391 0.165905 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for gaussian family taken to be 1.087348) ## ## Null deviance: 278.77 on 199 degrees of freedom ## Residual deviance: 210.95 on 194 degrees of freedom ## AIC: 592.23 ## ## Number of Fisher Scoring iterations: 2 There is no interaction here because the included interaction term was insignificant. In R, it is easy to fit interaction by *, e.g. dbp * race will automatically include all vars involved i.e. equal to glm(chol ~ dbp + race + dbp:race, data = coronary). Use : to just include interaction. 1.4.4 Model fit assessment: Residuals Histogram Raw residuals: Normality assumption. rraw_chol = resid(mlr_chol_sel) # unstandardized hist(rraw_chol) boxplot(rraw_chol) # normally distributed Scatter plots Standardized residuals vs Standardized predicted values: Overall – normality, linearity and equal variance assumptions. rstd_chol = rstandard(mlr_chol_sel) # standardized residuals pstd_chol = scale(predict(mlr_chol_sel)) # standardized predicted values plot(rstd_chol ~ pstd_chol, xlab = &quot;Std predicted&quot;, ylab = &quot;Std residuals&quot;) abline(0, 0) # normal, linear, equal variance The dots should form elliptical/oval shape (normality) and scattered roughly equal above and below the zero line (equal variance). Both these indicate linearity. Raw residuals vs Numerical predictor by each predictors: Linearity assumption. plot(rraw_chol ~ coronary$dbp, xlab = &quot;DBP&quot;, ylab = &quot;Raw Residuals&quot;) abline(0, 0) 1.4.5 Interpretation Now we have decided on our final model, rename the model, mlr_chol_final = mlr_chol_sel and interpret the model, tib_mlr = tidy(mlr_chol_final, conf.int = TRUE) rsq(mlr_chol_final, adj = T) ## [1] 0.2227869 1mmHg increase in DBP causes 0.03mmol/L increase in cholestrol, controlling for the effect of race. Being Chinese causes 0.36mmol/L increase in cholestrol in comparison to Malay, controlling for the effect of DBP. Being Indian causes 0.71mmol/L increase in cholestrol in comparison to Malay, controlling for the effect of DBP. DBP and race explains 22.3% variance in cholestrol. Use kable to come up with nice table, knitr::kable(tib_mlr, format = &quot;simple&quot;) term estimate std.error statistic p.value conf.low conf.high (Intercept) 3.2980283 0.4862132 6.783091 0.0000000 2.3450680 4.2509885 dbp 0.0311081 0.0061044 5.095998 0.0000008 0.0191437 0.0430726 racechinese 0.3599636 0.1821488 1.976207 0.0495342 0.0029586 0.7169687 raceindian 0.7136902 0.1908827 3.738893 0.0002425 0.3395669 1.0878136 tbl_regression(mlr_chol_final) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #paxudbbvol .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #paxudbbvol .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #paxudbbvol .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #paxudbbvol .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #paxudbbvol .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #paxudbbvol .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #paxudbbvol .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #paxudbbvol .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #paxudbbvol .gt_column_spanner_outer:first-child { padding-left: 0; } #paxudbbvol .gt_column_spanner_outer:last-child { padding-right: 0; } #paxudbbvol .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #paxudbbvol .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #paxudbbvol .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #paxudbbvol .gt_from_md > :first-child { margin-top: 0; } #paxudbbvol .gt_from_md > :last-child { margin-bottom: 0; } #paxudbbvol .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #paxudbbvol .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #paxudbbvol .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #paxudbbvol .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #paxudbbvol .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #paxudbbvol .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #paxudbbvol .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #paxudbbvol .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #paxudbbvol .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #paxudbbvol .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #paxudbbvol .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #paxudbbvol .gt_sourcenote { font-size: 90%; padding: 4px; } #paxudbbvol .gt_left { text-align: left; } #paxudbbvol .gt_center { text-align: center; } #paxudbbvol .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #paxudbbvol .gt_font_normal { font-weight: normal; } #paxudbbvol .gt_font_bold { font-weight: bold; } #paxudbbvol .gt_font_italic { font-style: italic; } #paxudbbvol .gt_super { font-size: 65%; } #paxudbbvol .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Characteristic Beta 95% CI1 p-value dbp 0.03 0.02, 0.04 race malay — — chinese 0.36 0.00, 0.72 0.050 indian 0.71 0.34, 1.1 1 CI = Confidence Interval Export it to a csv file for use later, write.csv(tib_mlr, &quot;mlr_final.csv&quot;) 1.4.6 Model equation Cholestrol level in mmol/L can be predicted by its predictors as given by, \\[chol = 3.30 + 0.03\\times dbp + 0.36\\times race\\ (chinese) + 0.71\\times race\\ (indian)\\] 1.4.7 Prediction It is easy to predict in R using our fitted model above. First we view the predicted values for our sample, coronary$pred_chol = predict(mlr_chol_final) # coronary = coronary %&gt;% mutate(pred_chol = predict(mlr_chol_final)) head(coronary) ## id cad sbp dbp chol age bmi race gender pred_chol ## 1 1 no cad 106 68 6.5725 60 38.9 indian woman 6.127070 ## 2 14 no cad 130 78 6.3250 34 37.8 malay woman 5.724461 ## 3 56 no cad 136 84 5.9675 36 40.5 malay woman 5.911109 ## 4 61 no cad 138 100 7.0400 45 37.6 malay woman 6.408839 ## 5 62 no cad 115 85 6.6550 53 40.3 indian man 6.655908 ## 6 64 no cad 124 72 5.9675 43 37.6 malay man 5.537812 Now let us try predicting for any value for dbp and race for a subject, # dbp = 90, race = indian predict(mlr_chol_final, list(dbp = 90, race = &quot;indian&quot;)) ## 1 ## 6.811448 Now for many subjects, new_data = data.frame(dbp = c(90, 90, 90), race = c(&quot;malay&quot;, &quot;chinese&quot;, &quot;indian&quot;)) new_data ## dbp race ## 1 90 malay ## 2 90 chinese ## 3 90 indian predict(mlr_chol_final, new_data) ## 1 2 3 ## 6.097758 6.457722 6.811448 new_data$pred_chol = predict(mlr_chol_final, new_data) new_data ## dbp race pred_chol ## 1 90 malay 6.097758 ## 2 90 chinese 6.457722 ## 3 90 indian 6.811448 1.5 Exercises replace dbp with sbp replace race with age obtain coefficient for 5mmHg increase in DBP "],["logistic-regression.html", "Chapter 2 Logistic Regression 2.1 Introduction 2.2 Odds ratio vs relative risk 2.3 Preliminaries 2.4 Simple logistic regression (SLogR) 2.5 Multiple logistic regression (MLogR) 2.6 Exercises", " Chapter 2 Logistic Regression 2.1 Introduction Statistical method to model relationship between: outcome: binary categorical variable. predictors/independent variables: numerical, categorical variables. A type of Generalized Linear Models (GLMs). Basically, the relationship is structured as follows, \\[binary\\ outcome = numerical\\ predictors + categorical\\ predictors\\] more accurately, the logistic relationship structure, \\[log_e\\bigg({proportion \\over 1 - proportion}\\bigg) = numerical\\ predictors + categorical\\ predictors\\] We turned the binary outcome into proportion (\\(p\\)) of having the outcome. \\(log_e\\) is the natural log, sometimes written as ln. The part, \\(\\frac{p}{1-p}\\) is known as odds. 2.2 Odds ratio vs relative risk Association analysis for cross-tabulation of a binary factor and its outcome can be expressed as odds ratio. Odds is a measure of chance of disease occurence in a specified group, \\[Odds = \\frac{n_{disease}}{n_{no\\ disease}}\\] Odds ratio, OR is the ratio between the odds of two groups; the group with the risk factor and the group without the risk factor, \\[Odds\\ ratio, OR = \\frac{Odds_{factor}}{Odds_{no\\ factor}}\\] Odds ratio can be calculated for cohort, cross-sectional and case-control studied because it does not imply a cause-effect association, but only plain association. In epidemiology, it is common to describe the association between a risk factor and a disease in term of risk and relative risk. Risk is a measure of chance of disease occurence in a specified group, calculated as \\[Risk = \\frac{n_{disease}}{n_{group}}\\] Relative risk is the ration between the risk in the group with the factor and the risk in the group without the risk factor, \\[Relative\\ risk, RR = \\frac{Risk_{factor}}{Risk_{no\\ factor}}\\] It is only approriate to calculate risk and relative risk for cohort studies, because the cause-effect relationship is well defined. OR is a good approximation of RR whenever the disease is rare. Rare diseases are commonly studied using case-control studies, thus the use of ORs are justified. As an example, we can calculate odds, OR, risk and RR from the following table. Smoker vs lung cancer Lung cancer No lung cancer Marginal total Odds Risk Smoker 20 12 32 20/12 = 1.667 20/32 = 0.625 Non smoker 95 73 168 95/73 = 1.301 95/168 = 0.565 Thus OR and RR equal, \\[OR = 1.667/1.301 = 1.281\\] \\[RR = 0.625/0.565 = 1.106\\] 2.3 Preliminaries 2.3.1 Library # official CRAN library(foreign) library(tidyverse) library(gtsummary) library(ggplot2) library(ggpubr) library(GGally) library(psych) library(rsq) library(broom) library(ResourceSelection) ## ResourceSelection 0.3-5 2019-07-22 # custom function # desc_cat() source(&quot;https://raw.githubusercontent.com/wnarifin/medicalstats-in-R/master/functions/desc_cat_fun.R&quot;) 2.3.2 Data coronary = read.dta(&quot;coronary.dta&quot;) str(coronary) ## &#39;data.frame&#39;: 200 obs. of 9 variables: ## $ id : num 1 14 56 61 62 64 69 108 112 134 ... ## $ cad : Factor w/ 2 levels &quot;no cad&quot;,&quot;cad&quot;: 1 1 1 1 1 1 2 1 1 1 ... ## $ sbp : num 106 130 136 138 115 124 110 112 138 104 ... ## $ dbp : num 68 78 84 100 85 72 80 70 85 70 ... ## $ chol : num 6.57 6.33 5.97 7.04 6.66 ... ## $ age : num 60 34 36 45 53 43 44 50 43 48 ... ## $ bmi : num 38.9 37.8 40.5 37.6 40.3 ... ## $ race : Factor w/ 3 levels &quot;malay&quot;,&quot;chinese&quot;,..: 3 1 1 1 3 1 1 2 2 2 ... ## $ gender: Factor w/ 2 levels &quot;woman&quot;,&quot;man&quot;: 1 1 1 1 2 2 2 1 1 2 ... ## - attr(*, &quot;datalabel&quot;)= chr &quot;Written by R. &quot; ## - attr(*, &quot;time.stamp&quot;)= chr &quot;&quot; ## - attr(*, &quot;formats&quot;)= chr &quot;%9.0g&quot; &quot;%9.0g&quot; &quot;%9.0g&quot; &quot;%9.0g&quot; ... ## - attr(*, &quot;types&quot;)= int 100 108 100 100 100 100 100 108 108 ## - attr(*, &quot;val.labels&quot;)= chr &quot;&quot; &quot;cad&quot; &quot;&quot; &quot;&quot; ... ## - attr(*, &quot;var.labels&quot;)= chr &quot;id&quot; &quot;cad&quot; &quot;sbp&quot; &quot;dbp&quot; ... ## - attr(*, &quot;version&quot;)= int 7 ## - attr(*, &quot;label.table&quot;)=List of 3 ## ..$ cad : Named int 1 2 ## .. ..- attr(*, &quot;names&quot;)= chr &quot;no cad&quot; &quot;cad&quot; ## ..$ race : Named int 1 2 3 ## .. ..- attr(*, &quot;names&quot;)= chr &quot;malay&quot; &quot;chinese&quot; &quot;indian&quot; ## ..$ gender: Named int 1 2 ## .. ..- attr(*, &quot;names&quot;)= chr &quot;woman&quot; &quot;man&quot; Descriptive statistics coronary %&gt;% select(-id) %&gt;% tbl_summary(by = cad, statistic = all_continuous() ~ &quot;{mean} ({sd})&quot;, digits = all_continuous() ~ 1) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #ybrpoqzivo .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #ybrpoqzivo .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ybrpoqzivo .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #ybrpoqzivo .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #ybrpoqzivo .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ybrpoqzivo .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ybrpoqzivo .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #ybrpoqzivo .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #ybrpoqzivo .gt_column_spanner_outer:first-child { padding-left: 0; } #ybrpoqzivo .gt_column_spanner_outer:last-child { padding-right: 0; } #ybrpoqzivo .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #ybrpoqzivo .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #ybrpoqzivo .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #ybrpoqzivo .gt_from_md > :first-child { margin-top: 0; } #ybrpoqzivo .gt_from_md > :last-child { margin-bottom: 0; } #ybrpoqzivo .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #ybrpoqzivo .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #ybrpoqzivo .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ybrpoqzivo .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #ybrpoqzivo .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ybrpoqzivo .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #ybrpoqzivo .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #ybrpoqzivo .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ybrpoqzivo .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ybrpoqzivo .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #ybrpoqzivo .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ybrpoqzivo .gt_sourcenote { font-size: 90%; padding: 4px; } #ybrpoqzivo .gt_left { text-align: left; } #ybrpoqzivo .gt_center { text-align: center; } #ybrpoqzivo .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #ybrpoqzivo .gt_font_normal { font-weight: normal; } #ybrpoqzivo .gt_font_bold { font-weight: bold; } #ybrpoqzivo .gt_font_italic { font-style: italic; } #ybrpoqzivo .gt_super { font-size: 65%; } #ybrpoqzivo .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Characteristic no cad, N = 1631 cad, N = 371 sbp 127.8 (19.1) 140.5 (19.7) dbp 80.8 (12.6) 89.0 (12.2) chol 6.1 (1.2) 6.6 (1.2) age 46.8 (7.4) 49.7 (6.7) bmi 37.6 (2.5) 36.9 (3.4) race malay 60 (37%) 13 (35%) chinese 52 (32%) 12 (32%) indian 51 (31%) 12 (32%) gender woman 87 (53%) 13 (35%) man 76 (47%) 24 (65%) 1 Mean (SD); n (%) 2.4 Simple logistic regression (SLogR) 2.4.1 About SLogR Model relatioship between: outcome: binary categorical variable. a predictor: numerical or binary categorical variable. Formula, \\[log_e\\bigg(\\frac{p}{1-p}\\bigg) = intercept + coefficient \\times numerical/binary\\ predictor\\] or in a proper equation form, \\[log_e\\bigg(\\frac{p}{1-p}\\bigg) = \\beta_0 + \\beta_1x_1\\] Odds ratio is easily obtained from a logistic regression, \\[OR_1 = e^{\\beta_1}\\] 4. \\(p\\) – proportion/probability. To obtain \\(p\\), \\[p = \\frac{e^{\\beta_0 + \\beta_1x_1}}{1 + e^{\\beta_0 + \\beta_1x_1}}\\] But as we will see later, this can be easily obtained in R. 2.4.2 Data exploration Descriptive statistics coronary %&gt;% select(gender, cad) %&gt;% desc_cat() ## $gender ## Variable Label n Percent ## 1 gender woman 100 50 ## 2 - man 100 50 ## ## $cad ## Variable Label n Percent ## 1 cad no cad 163 81.5 ## 2 - cad 37 18.5 with(coronary, table(gender, cad)) %&gt;% print() %&gt;% prop.table(margin = 2) * 100 ## cad ## gender no cad cad ## woman 87 13 ## man 76 24 ## cad ## gender no cad cad ## woman 53.37423 35.13514 ## man 46.62577 64.86486 2.4.3 Fit Univariable SLogR Fit model, # cad ~ gender slg_cad = glm(cad ~ gender, data = coronary, family = binomial) summary(slg_cad) ## ## Call: ## glm(formula = cad ~ gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -0.7409 -0.7409 -0.5278 -0.5278 2.0200 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -1.9010 0.2973 -6.393 1.63e-10 *** ## genderman 0.7483 0.3785 1.977 0.048 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 187.49 on 198 degrees of freedom ## AIC: 191.49 ## ## Number of Fisher Scoring iterations: 4 tidy(slg_cad, conf.int = TRUE, exponentiate = TRUE) # OR ## # A tibble: 2 × 7 ## term estimate std.error statistic p.value conf.low conf.high ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (Intercept) 0.149 0.297 -6.39 1.63e-10 0.0796 0.258 ## 2 genderman 2.11 0.378 1.98 4.80e- 2 1.02 4.55 Focus on: Coefficient, \\(\\beta\\) and OR. 95% CI. P-value. 2.4.4 Interpretation We are most interested in the OR, Man is at 2.11 odds of having coronary artery disease (CAD) as compared to woman. Be careful with the terms; odds vs risk! 2.4.5 Model equation \\[log_e\\bigg(\\frac{p_{cad}}{1-p_{cad}}\\bigg) = -1.90 + 0.75 \\times gender\\ (man)\\] \\[p_{cad} = \\frac{e^{-1.9 + 0.75 \\times gender\\ (man)}}{1 + {e^{-1.90 + 0.75 \\times gender\\ (man)}}}\\] Note: Don’t scratch your head. 2.5 Multiple logistic regression (MLogR) Model relatioship between: outcome: binary categorical variable. predictors: numerical, categorical variables. Formula, \\[\\begin{aligned} log_e\\bigg(\\frac{p}{1-p}\\bigg) = &amp;\\ intercept + coefficients \\times numerical\\ predictors \\\\ &amp; + coefficients \\times categorical\\ predictors \\end{aligned}\\] or in a nicer form, \\[log_e\\bigg(\\frac{p}{1-p}\\bigg) = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + ... + \\beta_kx_k\\] where we have k predictors. Whenever the predictor is a categorical variable with more than two levels, remember to consider dummy (binary) variable(s). 2.5.1 Data exploration Descriptive statistics coronary %&gt;% select(-id, -cad, -race, -gender) %&gt;% describeBy(., coronary$cad) # numerical ## ## Descriptive statistics by group ## group: no cad ## vars n mean sd median trimmed mad min max range skew ## sbp 1 163 127.84 19.14 124.00 126.33 17.79 88.00 187.00 99.00 0.68 ## dbp 2 163 80.80 12.61 80.00 80.11 14.83 56.00 120.00 64.00 0.50 ## chol 3 163 6.10 1.17 6.05 6.07 1.06 4.00 9.35 5.35 0.23 ## age 4 163 46.79 7.40 47.00 46.65 8.90 32.00 62.00 30.00 0.12 ## bmi 5 163 37.58 2.48 38.00 37.82 2.08 28.99 41.20 12.21 -0.91 ## kurtosis se ## sbp 0.04 1.50 ## dbp -0.12 0.99 ## chol -0.29 0.09 ## age -0.75 0.58 ## bmi 0.72 0.19 ## ------------------------------------------------------------ ## group: cad ## vars n mean sd median trimmed mad min max range skew ## sbp 1 37 140.49 19.67 138.00 140.45 25.20 100.00 178.00 78.00 -0.02 ## dbp 2 37 88.97 12.17 90.00 88.58 14.83 70.00 114.00 44.00 0.25 ## chol 3 37 6.65 1.17 6.66 6.65 0.90 4.12 9.05 4.92 -0.01 ## age 4 37 49.70 6.66 50.00 49.84 7.41 35.00 61.00 26.00 -0.18 ## bmi 5 37 36.86 3.39 37.14 36.69 3.23 31.00 45.03 14.03 0.34 ## kurtosis se ## sbp -1.06 3.23 ## dbp -1.01 2.00 ## chol -0.28 0.19 ## age -0.88 1.10 ## bmi -0.22 0.56 coronary %&gt;% select(race, gender) %&gt;% by(., coronary$cad, desc_cat) # categorical ## coronary$cad: no cad ## $race ## Variable Label n Percent ## 1 race malay 60 36.80982 ## 2 - chinese 52 31.90184 ## 3 - indian 51 31.28834 ## ## $gender ## Variable Label n Percent ## 1 gender woman 87 53.37423 ## 2 - man 76 46.62577 ## ## ------------------------------------------------------------ ## coronary$cad: cad ## $race ## Variable Label n Percent ## 1 race malay 13 35.13514 ## 2 - chinese 12 32.43243 ## 3 - indian 12 32.43243 ## ## $gender ## Variable Label n Percent ## 1 gender woman 13 35.13514 ## 2 - man 24 64.86486 # or just use tbl_summary() Plots coronary %&gt;% select(-id, -cad) %&gt;% by(., coronary$cad, ggpairs) # or using built-in graphics ## coronary$cad: no cad ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## ------------------------------------------------------------ ## coronary$cad: cad ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. 2.5.2 Variable selection Fit Univariable SLogR Perform SLogR for sbp, dbp, chol, age, bmi, race and gender on your own. Now, we want to determine which variables are worthwhile to include in the multivariable models. We want to screen variables with P-values &lt; 0.25 to be included in MLogR. Obtaining the P-values for each variable is easy by LR test, slg_cad0 = glm(cad ~ 1, data = coronary, family = binomial) summary(slg_cad0) ## ## Call: ## glm(formula = cad ~ 1, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -0.6396 -0.6396 -0.6396 -0.6396 1.8371 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -1.4828 0.1821 -8.143 3.86e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 191.56 on 199 degrees of freedom ## AIC: 193.56 ## ## Number of Fisher Scoring iterations: 4 add1(slg_cad0, scope = ~ sbp + dbp + chol + age + bmi + race + gender, test = &quot;LRT&quot;) ## Single term additions ## ## Model: ## cad ~ 1 ## Df Deviance AIC LRT Pr(&gt;Chi) ## &lt;none&gt; 191.56 193.56 ## sbp 1 179.62 183.62 11.9339 0.0005512 *** ## dbp 1 179.62 183.62 11.9333 0.0005514 *** ## chol 1 185.04 189.04 6.5187 0.0106747 * ## age 1 186.72 190.72 4.8346 0.0278945 * ## bmi 1 189.38 193.38 2.1811 0.1397120 ## race 2 191.52 197.52 0.0385 0.9809448 ## gender 1 187.49 191.49 4.0631 0.0438292 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 All variables are &lt; .25 except race. Fit Multivariable MLogR Perform MLogR with the selected variables. Modeling considerations: race not included, P-value &gt; 0.25 sbp not included, redundant. # all mlg_cad = glm(cad ~ dbp + chol + age + bmi + gender, data = coronary, family = binomial) summary(mlg_cad) ## ## Call: ## glm(formula = cad ~ dbp + chol + age + bmi + gender, family = binomial, ## data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.3847 -0.6228 -0.5055 -0.3562 2.3244 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -5.35585 3.22561 -1.660 0.0968 . ## dbp 0.03940 0.01678 2.348 0.0189 * ## chol 0.14300 0.18611 0.768 0.4423 ## age 0.01539 0.03081 0.500 0.6173 ## bmi -0.04021 0.06824 -0.589 0.5557 ## genderman 0.69514 0.40232 1.728 0.0840 . ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 173.70 on 194 degrees of freedom ## AIC: 185.7 ## ## Number of Fisher Scoring iterations: 4 At this point, focus on: Coefficients, \\(\\beta\\)s. P-values. Stepwise We proceed with stepwise automatic selection, # both mlg_cad_stepboth = step(mlg_cad, direction = &quot;both&quot;) ## Start: AIC=185.7 ## cad ~ dbp + chol + age + bmi + gender ## ## Df Deviance AIC ## - age 1 173.95 183.95 ## - bmi 1 174.05 184.05 ## - chol 1 174.29 184.29 ## &lt;none&gt; 173.70 185.70 ## - gender 1 176.77 186.77 ## - dbp 1 179.46 189.46 ## ## Step: AIC=183.95 ## cad ~ dbp + chol + bmi + gender ## ## Df Deviance AIC ## - bmi 1 174.26 182.26 ## - chol 1 174.80 182.80 ## &lt;none&gt; 173.95 183.95 ## - gender 1 177.40 185.40 ## + age 1 173.70 185.70 ## - dbp 1 180.91 188.91 ## ## Step: AIC=182.26 ## cad ~ dbp + chol + gender ## ## Df Deviance AIC ## - chol 1 175.21 181.21 ## &lt;none&gt; 174.26 182.26 ## - gender 1 177.86 183.86 ## + bmi 1 173.95 183.95 ## + age 1 174.05 184.05 ## - dbp 1 181.87 187.87 ## ## Step: AIC=181.2 ## cad ~ dbp + gender ## ## Df Deviance AIC ## &lt;none&gt; 175.21 181.21 ## + chol 1 174.26 182.26 ## + age 1 174.74 182.74 ## + bmi 1 174.80 182.80 ## - gender 1 179.62 183.62 ## - dbp 1 187.49 191.49 summary(mlg_cad_stepboth) # cad ~ dbp + gender ## ## Call: ## glm(formula = cad ~ dbp + gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.4520 -0.6508 -0.5249 -0.3643 2.3337 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -6.12046 1.31667 -4.648 3.34e-06 *** ## dbp 0.04950 0.01463 3.383 0.000717 *** ## genderman 0.80573 0.39084 2.062 0.039253 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 175.20 on 197 degrees of freedom ## AIC: 181.2 ## ## Number of Fisher Scoring iterations: 4 # forward mlg_cad_stepforward = step(slg_cad0, scope = ~ dbp + chol + age + bmi + gender, direction = &quot;forward&quot;) ## Start: AIC=193.56 ## cad ~ 1 ## ## Df Deviance AIC ## + dbp 1 179.62 183.62 ## + chol 1 185.04 189.04 ## + age 1 186.72 190.72 ## + gender 1 187.49 191.49 ## + bmi 1 189.38 193.38 ## &lt;none&gt; 191.56 193.56 ## ## Step: AIC=183.62 ## cad ~ dbp ## ## Df Deviance AIC ## + gender 1 175.21 181.21 ## &lt;none&gt; 179.62 183.62 ## + chol 1 177.86 183.86 ## + age 1 178.50 184.50 ## + bmi 1 178.98 184.98 ## ## Step: AIC=181.2 ## cad ~ dbp + gender ## ## Df Deviance AIC ## &lt;none&gt; 175.21 181.21 ## + chol 1 174.26 182.26 ## + age 1 174.74 182.74 ## + bmi 1 174.80 182.80 summary(mlg_cad_stepforward) # cad ~ dbp + gender ## ## Call: ## glm(formula = cad ~ dbp + gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.4520 -0.6508 -0.5249 -0.3643 2.3337 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -6.12046 1.31667 -4.648 3.34e-06 *** ## dbp 0.04950 0.01463 3.383 0.000717 *** ## genderman 0.80573 0.39084 2.062 0.039253 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 175.20 on 197 degrees of freedom ## AIC: 181.2 ## ## Number of Fisher Scoring iterations: 4 # backward mlg_cad_stepback = step(mlg_cad, direction = &quot;backward&quot;) ## Start: AIC=185.7 ## cad ~ dbp + chol + age + bmi + gender ## ## Df Deviance AIC ## - age 1 173.95 183.95 ## - bmi 1 174.05 184.05 ## - chol 1 174.29 184.29 ## &lt;none&gt; 173.70 185.70 ## - gender 1 176.77 186.77 ## - dbp 1 179.46 189.46 ## ## Step: AIC=183.95 ## cad ~ dbp + chol + bmi + gender ## ## Df Deviance AIC ## - bmi 1 174.26 182.26 ## - chol 1 174.80 182.80 ## &lt;none&gt; 173.95 183.95 ## - gender 1 177.40 185.40 ## - dbp 1 180.91 188.91 ## ## Step: AIC=182.26 ## cad ~ dbp + chol + gender ## ## Df Deviance AIC ## - chol 1 175.21 181.21 ## &lt;none&gt; 174.26 182.26 ## - gender 1 177.86 183.86 ## - dbp 1 181.87 187.87 ## ## Step: AIC=181.2 ## cad ~ dbp + gender ## ## Df Deviance AIC ## &lt;none&gt; 175.21 181.21 ## - gender 1 179.62 183.62 ## - dbp 1 187.49 191.49 summary(mlg_cad_stepback) # cad ~ dbp + gender ## ## Call: ## glm(formula = cad ~ dbp + gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.4520 -0.6508 -0.5249 -0.3643 2.3337 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -6.12046 1.31667 -4.648 3.34e-06 *** ## dbp 0.04950 0.01463 3.383 0.000717 *** ## genderman 0.80573 0.39084 2.062 0.039253 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 175.20 on 197 degrees of freedom ## AIC: 181.2 ## ## Number of Fisher Scoring iterations: 4 Our chosen model: cad ~ dbp + gender` mlg_cad_sel = glm(cad ~ dbp + gender, data = coronary, family = binomial) summary(mlg_cad_sel) ## ## Call: ## glm(formula = cad ~ dbp + gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.4520 -0.6508 -0.5249 -0.3643 2.3337 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -6.12046 1.31667 -4.648 3.34e-06 *** ## dbp 0.04950 0.01463 3.383 0.000717 *** ## genderman 0.80573 0.39084 2.062 0.039253 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 175.20 on 197 degrees of freedom ## AIC: 181.2 ## ## Number of Fisher Scoring iterations: 4 tidy(mlg_cad_sel, conf.int = TRUE) ## # A tibble: 3 × 7 ## term estimate std.error statistic p.value conf.low conf.high ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (Intercept) -6.12 1.32 -4.65 0.00000334 -8.83 -3.64 ## 2 dbp 0.0495 0.0146 3.38 0.000717 0.0215 0.0793 ## 3 genderman 0.806 0.391 2.06 0.0393 0.0538 1.60 tbl_regression(mlg_cad_sel) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #ermebxxsxr .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #ermebxxsxr .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ermebxxsxr .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #ermebxxsxr .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #ermebxxsxr .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ermebxxsxr .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ermebxxsxr .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #ermebxxsxr .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #ermebxxsxr .gt_column_spanner_outer:first-child { padding-left: 0; } #ermebxxsxr .gt_column_spanner_outer:last-child { padding-right: 0; } #ermebxxsxr .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #ermebxxsxr .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #ermebxxsxr .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #ermebxxsxr .gt_from_md > :first-child { margin-top: 0; } #ermebxxsxr .gt_from_md > :last-child { margin-bottom: 0; } #ermebxxsxr .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #ermebxxsxr .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #ermebxxsxr .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ermebxxsxr .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #ermebxxsxr .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ermebxxsxr .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #ermebxxsxr .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #ermebxxsxr .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ermebxxsxr .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ermebxxsxr .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #ermebxxsxr .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ermebxxsxr .gt_sourcenote { font-size: 90%; padding: 4px; } #ermebxxsxr .gt_left { text-align: left; } #ermebxxsxr .gt_center { text-align: center; } #ermebxxsxr .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #ermebxxsxr .gt_font_normal { font-weight: normal; } #ermebxxsxr .gt_font_bold { font-weight: bold; } #ermebxxsxr .gt_font_italic { font-style: italic; } #ermebxxsxr .gt_super { font-size: 65%; } #ermebxxsxr .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Characteristic log(OR)1 95% CI1 p-value dbp 0.05 0.02, 0.08 gender woman — — man 0.81 0.05, 1.6 0.039 1 OR = Odds Ratio, CI = Confidence Interval rsq(mlg_cad_sel) ## [1] 0.08189364 Multicollinearity, MC Multicollinearity is the problem of redundant variables, in other words, high correlations between predictors. For logistic regression, this is checked by looking at the estimates and standard errors, SEs. Whenever SE is larger than the estimate, this may point to an MC problem. But how large is large? Relatively large, this is not mentioned specifically in Hosmer, Lemeshow, &amp; Sturdivant (2013). My own guess is that the ratio between SE:estimate should be &lt; 1. Sometimes, the estimates are unusually large, i.e. indicates very large ORs. This is illogical – also indicates an MC problem. Again we look at our mlg_cad_sel model, cad ~ dbp + gender ## cad ~ dbp + gender summary(mlg_cad_sel) ## ## Call: ## glm(formula = cad ~ dbp + gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.4520 -0.6508 -0.5249 -0.3643 2.3337 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -6.12046 1.31667 -4.648 3.34e-06 *** ## dbp 0.04950 0.01463 3.383 0.000717 *** ## genderman 0.80573 0.39084 2.062 0.039253 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 175.20 on 197 degrees of freedom ## AIC: 181.2 ## ## Number of Fisher Scoring iterations: 4 Fortunately, all SEs &lt; estimates/coefficients. Interaction, * Interaction is the predictor variable combination that necessitates the interpretation of regression coefficients separately based for each level of the predictor (e.g. separate analysis for male vs female). Again, this makes interpreting our analysis complicated. So, most of the time, we pray not to have interaction in our regression model. summary(glm(cad ~ dbp * gender, data = coronary, family = binomial)) ## ## Call: ## glm(formula = cad ~ dbp * gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.3876 -0.6677 -0.5317 -0.3306 2.4107 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -7.06999 2.50172 -2.826 0.00471 ** ## dbp 0.06029 0.02807 2.148 0.03169 * ## genderman 2.11719 2.91088 0.727 0.46702 ## dbp:genderman -0.01501 0.03288 -0.456 0.64815 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 174.99 on 196 degrees of freedom ## AIC: 182.99 ## ## Number of Fisher Scoring iterations: 5 # insig. dbp * gender There was no significant interaction to be included in out model. 2.5.3 Model fit assessment There are three model fit assessment methods commonly done for logistic regression: Hosmer-Lemeshow test. Classification table. Area Under the Curve (AUC) of Receiver Operating Characteristics (ROC) curve. Basically, we want to compare the real cad status (observed) against the predicted cad status and probability (as predicted by our logistic regression model). Hosmer-Lemeshow test. P-value &gt; 0.05 – Model (predicted counts) fit the data (observed counts). hl_cad = hoslem.test(mlg_cad_sel$y, mlg_cad_sel$fitted.values) hl_cad ## ## Hosmer and Lemeshow goodness of fit (GOF) test ## ## data: mlg_cad_sel$y, mlg_cad_sel$fitted.values ## X-squared = 18.199, df = 8, p-value = 0.01978 P-value &lt; 0.05, the model does not fit (slightly). Ideally &gt; 0.05. Usually this happens because of small number of variables in the model. Detailed counts, cbind(hl_cad$observed, hl_cad$expected) ## y0 y1 yhat0 yhat1 ## [0.0374,0.0657] 20 2 20.711530 1.288470 ## (0.0657,0.0875] 18 2 18.368872 1.631128 ## (0.0875,0.123] 22 0 19.644094 2.355906 ## (0.123,0.136] 24 0 20.787142 3.212858 ## (0.136,0.159] 11 2 11.005310 1.994690 ## (0.159,0.18] 16 3 15.748367 3.251633 ## (0.18,0.205] 14 10 19.208277 4.791723 ## (0.205,0.239] 15 3 13.872019 4.127981 ## (0.239,0.319] 11 9 14.170991 5.829009 ## (0.319,0.652] 12 6 9.483399 8.516601 Classification table. Cross-tabulate cad observed cad status vs predicted cad status. Good model fit if &gt; 70% of the subjects are correctly classified. We must create probability and predicted cad variables, cad_prob and cad_pred, coronary$cad_prob = mlg_cad_sel$fitted.values # save predicted probabilities We set cutoff of probability (cad_prob) \\(\\leq\\) 0.5 for no cad and probability &gt; 0.5 for cad, coronary$cad_pred = ifelse(coronary$cad_prob &gt; 0.5, &quot;cad&quot;, &quot;no cad&quot;) %&gt;% as.factor() Cross-tabulate cad vs cad_predicted, table(coronary$cad, coronary$cad_pred) ## ## cad no cad ## no cad 6 157 ## cad 3 34 Then calculate the correctly classified %, # correctly classified % 100 * sum(coronary$cad == coronary$cad_pred) / length(coronary$cad) # = 80% ## [1] 80 Area Under the Curve (AUC) of Receiver Operating Characteristics (ROC) curve. It measures the ability of a model to disciminate cad vs non-cad subjects. AUC is also known as C-statistic (“C” stands for “concordance”). AUC &gt; 0.7 indicates acceptable model fit. AUC \\(\\leq\\) 0.5 shows no discrimination at all, unaceptable. roc_cad = epiDisplay::lroc(mlg_cad_sel) roc_cad$auc # acceptable ## [1] 0.7320511 The model fulfill 2 out of 3 criteria we set for model fit assessment. 2.5.4 Interpretation Now we have decided on our final model, rename the model, mlg_cad_final = mlg_cad_sel and interpret the ORs of the model, summary(mlg_cad_final) ## ## Call: ## glm(formula = cad ~ dbp + gender, family = binomial, data = coronary) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.4520 -0.6508 -0.5249 -0.3643 2.3337 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -6.12046 1.31667 -4.648 3.34e-06 *** ## dbp 0.04950 0.01463 3.383 0.000717 *** ## genderman 0.80573 0.39084 2.062 0.039253 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 191.56 on 199 degrees of freedom ## Residual deviance: 175.20 on 197 degrees of freedom ## AIC: 181.2 ## ## Number of Fisher Scoring iterations: 4 tib_mlg = tidy(mlg_cad_final, conf.int = TRUE, exponentiate = TRUE) # in Odds ratio 1mmHg increase in DBP increase the odds of cad by 1.05 times (or 5%), controlling the effect of gender. Man has 2.24 times odds of cad as compared to woman, controlling for the effect of DBP. Notice that for numerical predictor, it sounds odd to interpret the OR for 1 unit increase. We can obtain the OR for any specific increase in the value (a constant, \\(c\\)), e.g. 5 or 10 unit increase etc. To obtain the OR simply multiply the coefficient \\(beta\\) (careful, not OR) by the needed constant value, \\(c\\)$, \\[OR = e^{(c \\times \\beta)}\\] To obtain the OR of 10mmHg increase in DBP, \\[OR_{10\\times dbp} = e^{10\\times0.05} = e^{0.5} = 1.65\\] exp(10*0.05) ## [1] 1.648721 or more precisely, directly from our model, coef(mlg_cad_final) ## (Intercept) dbp genderman ## -6.12046337 0.04950439 0.80572747 exp(10*coef(mlg_cad_final)[2]) ## dbp ## 1.64057 10mmHg increase in DBP increase the odds of cad by 1.64 times (or 64%), controlling the effect of gender. We can also obtain \\(R^2\\) for the logistic regression model, rsq(mlg_cad_final, adj = T) ## [1] 0.07257276 DBP and gender explains (only) 7.3% variance in cad. This is quite low, which indicates that there are more predictors we should consider to predict cad occurrence. Note: R-squared is usually reported for linear regression. But R-squared is also available for GLM, in our case logistic regression. This is usually known as pseudo-R-squared. In GLM, it is made possible by the work of Zhang (2017), the author of “rsq” package. 2.5.5 Model equations Our basic logistic regression equation is given by, \\[log_e\\bigg(\\frac{p_{cad}}{1-p_{cad}}\\bigg) = -6.12 + 0.05 \\times\\ dbp + 0.81 \\times gender\\ (man)\\] CAD probability is given by, \\[p_{cad} = \\frac{e^{-6.12 + 0.05 \\times\\ dbp + 0.81 \\times gender\\ (man)}}{1 + {e^{-6.12 + 0.05 \\times\\ dbp + 0.81 \\times gender\\ (man)}}}\\] Note: Again, don’t scratch your head. 2.5.6 Prediction It is easy to predict in R using our fitted model above. First we view the predicted values for our sample, coronary$cad_prob = predict(mlg_cad_final, type = &quot;response&quot;) # in probability # converted from logit, by adding type = &quot;response&quot; head(coronary$cad_prob) ## [1] 0.05985186 0.09456561 0.12324054 0.23685057 0.24845622 0.14799425 You can also use mlg_cad_final$fitted.values as we did before for cad_prob. But as we will see below, we need predict() for new data, so we need to use the proper predict() function. Now let us try predicting for a subject, # dbp = 110, gender = man predict(mlg_cad_final, list(dbp = 110, gender = &quot;man&quot;), type = &quot;response&quot;) ## 1 ## 0.5326403 # probability &gt; 0.5 = cad Now for many subjects, new_data = data.frame(dbp = c(100, 110, 120, 100, 110, 120), gender = c(&quot;man&quot;, &quot;man&quot;, &quot;man&quot;, &quot;woman&quot;, &quot;woman&quot;, &quot;woman&quot;)) new_data ## dbp gender ## 1 100 man ## 2 110 man ## 3 120 man ## 4 100 woman ## 5 110 woman ## 6 120 woman predict(mlg_cad_final, new_data, type = &quot;response&quot;) ## 1 2 3 4 5 6 ## 0.4099198 0.5326403 0.6515344 0.2368506 0.3373825 0.4551368 new_data$prob_cad = predict(mlg_cad_final, new_data, type = &quot;response&quot;) new_data ## dbp gender prob_cad ## 1 100 man 0.4099198 ## 2 110 man 0.5326403 ## 3 120 man 0.6515344 ## 4 100 woman 0.2368506 ## 5 110 woman 0.3373825 ## 6 120 woman 0.4551368 new_data$pred_cad = cut(new_data$prob_cad, breaks = c(-Inf, 0.5, Inf), labels = c(&quot;no cad&quot;, &quot;cad&quot;)) # alternative to ifelse new_data ## dbp gender prob_cad pred_cad ## 1 100 man 0.4099198 no cad ## 2 110 man 0.5326403 cad ## 3 120 man 0.6515344 cad ## 4 100 woman 0.2368506 no cad ## 5 110 woman 0.3373825 no cad ## 6 120 woman 0.4551368 no cad 2.6 Exercises obtain OR for 5mmHg increase in DBP References Hosmer, D. W., Lemeshow, S., &amp; Sturdivant, R. X. (2013). Applied logistic regression. Wiley. Retrieved from https://books.google.com.my/books?id=bRoxQBIZRd4C Zhang, D. (2017). A coefficient of determination for generalized linear models. The American Statistician, 71(4), 310–316. https://doi.org/10.1080/00031305.2016.1256839 "],["references.html", "References", " References Arifin, W. N., Sarimah, A., Norsa’adah, B., Majdi, Y. N., Siti-Azrin, A. H., Imran, M. K., … Naing, L. (2016). Reporting statistical results in medical journals. The Malaysian Journal of Medical Sciences: MJMS, 23(5), 1. Hosmer, D. W., Lemeshow, S., &amp; Sturdivant, R. X. (2013). Applied logistic regression. Wiley. Retrieved from https://books.google.com.my/books?id=bRoxQBIZRd4C Kassambara, A. (2020). Ggpubr: ggplot2 based publication ready plots. Retrieved from https://rpkgs.datanovia.com/ggpubr/ Lele, S. R., Keim, J. L., &amp; Solymos, P. (2019). ResourceSelection: Resource selection (probability) functions for use-availability data. Retrieved from https://github.com/psolymos/ResourceSelection R Core Team. (2018). R: A language and environment for statistical computing. Vienna, Austria: R Foundation for Statistical Computing. Retrieved from https://www.R-project.org/ R Core Team. (2020). Foreign: Read data stored by minitab, s, SAS, SPSS, stata, systat, weka, dBase, ... Retrieved from https://CRAN.R-project.org/package=foreign Revelle, W. (2021). Psych: Procedures for psychological, psychometric, and personality research. Retrieved from https://personality-project.org/r/psych/ https://personality-project.org/r/psych-manual.pdf Robinson, D., Hayes, A., &amp; Couch, S. (2021). Broom: Convert statistical objects into tidy tibbles. Retrieved from https://CRAN.R-project.org/package=broom RStudio Team. (2018). RStudio: Integrated development environment for r. Boston, MA: RStudio, Inc. Retrieved from http://www.rstudio.com/ Schloerke, B., Cook, D., Larmarange, J., Briatte, F., Marbach, M., Thoen, E., … Crowley, J. (2021). GGally: Extension to ggplot2. Retrieved from https://CRAN.R-project.org/package=GGally Sjoberg, D. D., Curry, M., Hannum, M., Larmarange, J., Whiting, K., &amp; Zabor, E. C. (2021). Gtsummary: Presentation-ready data summary and analytic result tables. Retrieved from https://CRAN.R-project.org/package=gtsummary Wickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer-Verlag New York. Retrieved from https://ggplot2.tidyverse.org Wickham, H. (2021). Tidyverse: Easily install and load the tidyverse. Retrieved from https://CRAN.R-project.org/package=tidyverse Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., … Yutani, H. (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686. https://doi.org/10.21105/joss.01686 Wickham, H., Chang, W., Henry, L., Pedersen, T. L., Takahashi, K., Wilke, C., … Dunnington, D. (2021). ggplot2: Create elegant data visualisations using the grammar of graphics. Retrieved from https://CRAN.R-project.org/package=ggplot2 Zhang, D. (2017). A coefficient of determination for generalized linear models. The American Statistician, 71(4), 310–316. https://doi.org/10.1080/00031305.2016.1256839 Zhang, D. (2021). Rsq: R-squared and related measures. Retrieved from https://CRAN.R-project.org/package=rsq "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
